<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {
            background-color: #b3d9ff; /* Pastel xanh dương */
            font-family: Arial, sans-serif;
        }
        .navbar {
            background-color: #e0b3ff; /* Tím nhạt */
            padding: 10px;
            display: flex;
            justify-content: space-around;
        }
        .navbar a {
            color: #ffffff;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
        }
        .header {
            text-align: center;
            margin-top: 20px;
        }
        .header h1 {
            font-size: 36px;
            color: #003366; /* Đậm hơn cho tiêu đề */
        }
        .container {
            display: flex;
            justify-content: space-around;
            margin-top: 50px;
        }
        .left, .right {
            width: 45%;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .left h2, .right h2 {
            text-align: center;
            color: #003366;
        }
        .right h2 {
            cursor: pointer;
        }
        .workplace-link {
            text-align: center;
            margin-top: 20px;
            display: none;
        }
        .workplace-link a {
            color: #003366;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
        }
        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #d9b3ff; /* Pastel tím */
            color: #ffffff;
            border: none;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        .floating-btn span {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #ff0000;
            color: #ffffff;
            border-radius: 50%;
            padding: 5px 10px;
            font-size: 12px;
        }
        .message-popup {
            position: fixed;
            bottom: 60px;
            right: 20px;
            width: 300px;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: none;
        }
        .message-popup.active {
            display: block;
        }
        .message {
            background: #f4f4f4;
            margin: 10px 0;
            padding: 10px;
            border: 1px #ccc solid;
        }
        .message h3 {
            margin: 0 0 5px;
        }
        .reply {
            background: #e6f7ff;
            margin: 10px 0;
            padding: 10px;
            border: 1px #ccc solid;
        }
        .check-in {
            background-color: #e0f7fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        .check-in input[type="time"] {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #cccccc;
            border-radius: 5px;
            width: calc(50% - 22px); /* to align with 50% width */
            display: inline-block;
        }
        .check-in button {
            background-color: #e0b3ff;
            color: #ffffff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .check-in .date-display {
            margin-top: 20px;
            font-size: 14px;
            color: #003366;
            opacity: 0.5;
        }
    </style>
    <script>
        function toggleMessagePopup() {
            var messagePopup = document.getElementById('message-popup');
            messagePopup.classList.toggle('active');
        }
        function toggleProfileInfo() {
            var profileInfo = document.getElementById("profile-info");
            var updateForm = document.getElementById("update-form");
            if (updateForm.style.display === "none" || updateForm.style.display === "") {
                updateForm.style.display = "block";
                profileInfo.style.display = "none";
            } else {
                updateForm.style.display = "none";
                profileInfo.style.display = "block";
            }
        }
        function showWorkplaceLink() {
            document.getElementById("workplace-link").style.display = "block";
        }
        function toggleNotifications() {
            var notifications = document.getElementById('notifications');
            notifications.classList.toggle('active');
        }
        function toggleDarkMode() {
            var body = document.body;
            body.classList.toggle('dark-mode');
        }
        function displayCurrentDate() {
            var today = new Date();
            var dateDisplay = document.getElementById('date-display');
            dateDisplay.innerHTML = today.toDateString();
        }
        window.onload = displayCurrentDate;
    </script>
</head>
<body>
    <div class="navbar">
        <a href="{% url 'home' %}">Home</a>
        <a href="{% url 'register' %}">Register</a>
        <a href="{% url 'about_us' %}">About Us</a>
        <a href="{% url 'contact_us' %}">Contact Us</a>
    </div>
    <div class="header">
        <h1>Dashboard</h1>
    </div>
    <div class="container">
        <div class="left">
            <h2 onclick="toggleProfileInfo()">Your Profile</h2>
            <div class="profile-info" id="profile-info">
                <p>Name: {{ profile.user.first_name }}</p>
                <p>Full Name: {{ profile.user.last_name }}</p>
                <p>Date of Birth: {{ profile.birth_date }}</p>
                <p>Email: {{ profile.user.email }}</p>
                <p>Gender: {{ profile.gender }}</p>
                <p>Address: {{ profile.address }}</p>
                <p>Hometown: {{ profile.hometown }}</p>
                <p>Job Position: {{ profile.job_position }}</p>
                <button onclick="toggleProfileInfo()">Update Your Information</button>
            </div>
            <div id="update-form" style="display: none;">
                <form method="post">
                    {% csrf_token %}
                    <p>Date of Birth: {{ form.birth_date }}</p>
                    <p>Gender: {{ form.gender }}</p>
                    <p>Address: {{ form.address }}</p>
                    <p>Hometown: {{ form.hometown }}</p>
                    <p>Job Position: {{ form.job_position }}</p>
                    <button type="submit">Update Your Information</button>
                </form>
            </div>
        </div>
        <div class="right">
            <h2 onclick="showWorkplaceLink()">AutoPlate System</h2>
            <div id="workplace-link" class="workplace-link">
                <a href="{% url 'workplace' %}">Get in workplace</a>
            </div>
        </div>
    </div>
    <div class="check-in">
        <h2>Check-In</h2>
        <form method="post" action="{% url 'check_in' %}">
            {% csrf_token %}
            <label for="start_time">Start Time:</label>
            <input type="time" id="start_time" name="start_time" required>
            <label for="end_time">End Time:</label>
            <input type="time" id="end_time" name="end_time" required>
            <button type="submit">Check In</button>
        </form>
        <div id="date-display" class="date-display"></div>
    </div>
    <button class="floating-btn" onclick="toggleMessagePopup()">
        ✉️
        <span>{{ unread_messages_count }}</span>
    </button>
    <div id="message-popup" class="message-popup">
        {% for feedback in feedbacks %}
            <div class="message">
                <h3>Feedback:</h3>
                <p>{{ feedback.feedback }}</p>
                <p><strong>Sent on:</strong> {{ feedback.timestamp }}</p>
                {% if feedback.reply %}
                    <div class="reply">
                        <h3>Admin's Reply:</h3>
                        <p>{{ feedback.reply.reply }}</p>
                        <p><strong>Replied on:</strong> {{ feedback.reply.timestamp }}</p>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</body>
</html>
